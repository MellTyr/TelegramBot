package Weather;

import Interfaces.HaveCoordinate;
import Weather.WeatherApiModel.WeatherForecastModel;
import Weather.WeatherApiModel.WeatherModel;
import com.google.gson.*;

import java.io.*;
import java.net.HttpURLConnection;
import java.net.URL;

public class Weather {
    private static Weather weather;
    private final String weatherID= "57b2f40f256e95e8c450926b446c9130";
    private Weather() {
    }

    public static Weather getWeather() {
        if (weather == null)
            weather = new Weather();
        return weather;
    }

    //example string
    //String url="http://api.openweathermap.org/data/2.5/weather?q=London,uk&appid=57b2f40f256e95e8c450926b446c9130";

    //example by ID
    //http://api.openweathermap.org/data/2.5/weather?id=536203&appid=57b2f40f256e95e8c450926b446c9130

   // String json="{\"cod\":\"200\",\"message\":0.003,\"cnt\":40,\"list\":[{\"dt\":1541419200,\"main\":{\"temp\":281.32,\"temp_min\":278.9,\"temp_max\":281.32,\"pressure\":1039.27,\"sea_level\":1041.88,\"grnd_level\":1039.27,\"humidity\":94,\"temp_kf\":2.42},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":3.86,\"deg\":205.504},\"rain\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-05 12:00:00\"},{\"dt\":1541430000,\"main\":{\"temp\":279.61,\"temp_min\":277.798,\"temp_max\":279.61,\"pressure\":1038.41,\"sea_level\":1041,\"grnd_level\":1038.41,\"humidity\":95,\"temp_kf\":1.82},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.07,\"deg\":196.504},\"rain\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-05 15:00:00\"},{\"dt\":1541440800,\"main\":{\"temp\":278.31,\"temp_min\":277.101,\"temp_max\":278.31,\"pressure\":1037.73,\"sea_level\":1040.43,\"grnd_level\":1037.73,\"humidity\":98,\"temp_kf\":1.21},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"02n\"}],\"clouds\":{\"all\":8},\"wind\":{\"speed\":4.15,\"deg\":197.004},\"rain\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-05 18:00:00\"},{\"dt\":1541451600,\"main\":{\"temp\":278.03,\"temp_min\":277.427,\"temp_max\":278.03,\"pressure\":1037.55,\"sea_level\":1040.11,\"grnd_level\":1037.55,\"humidity\":100,\"temp_kf\":0.61},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03n\"}],\"clouds\":{\"all\":32},\"wind\":{\"speed\":3.54,\"deg\":198.001},\"rain\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-05 21:00:00\"},{\"dt\":1541462400,\"main\":{\"temp\":276.415,\"temp_min\":276.415,\"temp_max\":276.415,\"pressure\":1036.82,\"sea_level\":1039.53,\"grnd_level\":1036.82,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":3.49,\"deg\":191},\"rain\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-06 00:00:00\"},{\"dt\":1541473200,\"main\":{\"temp\":276.587,\"temp_min\":276.587,\"temp_max\":276.587,\"pressure\":1035.89,\"sea_level\":1038.55,\"grnd_level\":1035.89,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":80},\"wind\":{\"speed\":3.55,\"deg\":186.516},\"rain\":{\"3h\":0.015},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-06 03:00:00\"},{\"dt\":1541484000,\"main\":{\"temp\":277.131,\"temp_min\":277.131,\"temp_max\":277.131,\"pressure\":1035.73,\"sea_level\":1038.35,\"grnd_level\":1035.73,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":64},\"wind\":{\"speed\":3.56,\"deg\":188.509},\"rain\":{\"3h\":0.045},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-06 06:00:00\"},{\"dt\":1541494800,\"main\":{\"temp\":278.583,\"temp_min\":278.583,\"temp_max\":278.583,\"pressure\":1035.43,\"sea_level\":1038.01,\"grnd_level\":1035.43,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":3.14,\"deg\":189.002},\"rain\":{\"3h\":0.03},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-06 09:00:00\"},{\"dt\":1541505600,\"main\":{\"temp\":279.917,\"temp_min\":279.917,\"temp_max\":279.917,\"pressure\":1034.75,\"sea_level\":1037.32,\"grnd_level\":1034.75,\"humidity\":94,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":2.96,\"deg\":189.501},\"rain\":{\"3h\":0.06},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-06 12:00:00\"},{\"dt\":1541516400,\"main\":{\"temp\":279.545,\"temp_min\":279.545,\"temp_max\":279.545,\"pressure\":1034.3,\"sea_level\":1036.81,\"grnd_level\":1034.3,\"humidity\":96,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":3.29,\"deg\":185.502},\"rain\":{\"3h\":0.085},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-06 15:00:00\"},{\"dt\":1541527200,\"main\":{\"temp\":279.143,\"temp_min\":279.143,\"temp_max\":279.143,\"pressure\":1033.9,\"sea_level\":1036.48,\"grnd_level\":1033.9,\"humidity\":97,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":56},\"wind\":{\"speed\":3.56,\"deg\":185},\"rain\":{\"3h\":0.06},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-06 18:00:00\"},{\"dt\":1541538000,\"main\":{\"temp\":278.801,\"temp_min\":278.801,\"temp_max\":278.801,\"pressure\":1033.25,\"sea_level\":1035.75,\"grnd_level\":1033.25,\"humidity\":97,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":3.47,\"deg\":182.503},\"rain\":{\"3h\":0.07},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-06 21:00:00\"},{\"dt\":1541548800,\"main\":{\"temp\":278.955,\"temp_min\":278.955,\"temp_max\":278.955,\"pressure\":1032.33,\"sea_level\":1034.99,\"grnd_level\":1032.33,\"humidity\":96,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":64},\"wind\":{\"speed\":3.36,\"deg\":193.001},\"rain\":{\"3h\":0.03},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-07 00:00:00\"},{\"dt\":1541559600,\"main\":{\"temp\":279.22,\"temp_min\":279.22,\"temp_max\":279.22,\"pressure\":1031.05,\"sea_level\":1033.63,\"grnd_level\":1031.05,\"humidity\":96,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":32},\"wind\":{\"speed\":3.57,\"deg\":205.005},\"rain\":{\"3h\":0.005},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-07 03:00:00\"},{\"dt\":1541570400,\"main\":{\"temp\":279.073,\"temp_min\":279.073,\"temp_max\":279.073,\"pressure\":1030.91,\"sea_level\":1033.58,\"grnd_level\":1030.91,\"humidity\":97,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":64},\"wind\":{\"speed\":3.56,\"deg\":219.507},\"rain\":{\"3h\":0.015},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-07 06:00:00\"},{\"dt\":1541581200,\"main\":{\"temp\":280.335,\"temp_min\":280.335,\"temp_max\":280.335,\"pressure\":1031.33,\"sea_level\":1033.89,\"grnd_level\":1031.33,\"humidity\":97,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":80},\"wind\":{\"speed\":3.32,\"deg\":224.001},\"rain\":{\"3h\":0.055},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-07 09:00:00\"},{\"dt\":1541592000,\"main\":{\"temp\":280.924,\"temp_min\":280.924,\"temp_max\":280.924,\"pressure\":1031.44,\"sea_level\":1033.98,\"grnd_level\":1031.44,\"humidity\":95,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":2.52,\"deg\":233.002},\"rain\":{\"3h\":0.05},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-07 12:00:00\"},{\"dt\":1541602800,\"main\":{\"temp\":280.557,\"temp_min\":280.557,\"temp_max\":280.557,\"pressure\":1031.24,\"sea_level\":1033.84,\"grnd_level\":1031.24,\"humidity\":96,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":2.56,\"deg\":226.503},\"rain\":{\"3h\":0.07},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-07 15:00:00\"},{\"dt\":1541613600,\"main\":{\"temp\":280.056,\"temp_min\":280.056,\"temp_max\":280.056,\"pressure\":1031.18,\"sea_level\":1033.72,\"grnd_level\":1031.18,\"humidity\":97,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":2.06,\"deg\":217},\"rain\":{\"3h\":0.115},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-07 18:00:00\"},{\"dt\":1541624400,\"main\":{\"temp\":279.845,\"temp_min\":279.845,\"temp_max\":279.845,\"pressure\":1031.1,\"sea_level\":1033.71,\"grnd_level\":1031.1,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":1.6,\"deg\":211.502},\"rain\":{\"3h\":0.13},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-07 21:00:00\"},{\"dt\":1541635200,\"main\":{\"temp\":279.686,\"temp_min\":279.686,\"temp_max\":279.686,\"pressure\":1030.95,\"sea_level\":1033.49,\"grnd_level\":1030.95,\"humidity\":98,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":1.32,\"deg\":182.001},\"rain\":{\"3h\":0.11},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-08 00:00:00\"},{\"dt\":1541646000,\"main\":{\"temp\":279.59,\"temp_min\":279.59,\"temp_max\":279.59,\"pressure\":1030.66,\"sea_level\":1033.26,\"grnd_level\":1030.66,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":1.4,\"deg\":160.503},\"rain\":{\"3h\":0.14},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-08 03:00:00\"},{\"dt\":1541656800,\"main\":{\"temp\":279.407,\"temp_min\":279.407,\"temp_max\":279.407,\"pressure\":1030.69,\"sea_level\":1033.25,\"grnd_level\":1030.69,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":76},\"wind\":{\"speed\":1.46,\"deg\":136.502},\"rain\":{\"3h\":0.1},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-08 06:00:00\"},{\"dt\":1541667600,\"main\":{\"temp\":280.034,\"temp_min\":280.034,\"temp_max\":280.034,\"pressure\":1031.35,\"sea_level\":1033.84,\"grnd_level\":1031.35,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":1.41,\"deg\":125.503},\"rain\":{\"3h\":0.08},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-08 09:00:00\"},{\"dt\":1541678400,\"main\":{\"temp\":280.326,\"temp_min\":280.326,\"temp_max\":280.326,\"pressure\":1031.38,\"sea_level\":1033.94,\"grnd_level\":1031.38,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":80},\"wind\":{\"speed\":1.36,\"deg\":109.502},\"rain\":{\"3h\":0.105},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-08 12:00:00\"},{\"dt\":1541689200,\"main\":{\"temp\":279.787,\"temp_min\":279.787,\"temp_max\":279.787,\"pressure\":1031.5,\"sea_level\":1034.13,\"grnd_level\":1031.5,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":1.71,\"deg\":95.5016},\"rain\":{\"3h\":0.1375},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-08 15:00:00\"},{\"dt\":1541700000,\"main\":{\"temp\":279.438,\"temp_min\":279.438,\"temp_max\":279.438,\"pressure\":1031.74,\"sea_level\":1034.32,\"grnd_level\":1031.74,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":2.51,\"deg\":102.005},\"rain\":{\"3h\":0.15},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-08 18:00:00\"},{\"dt\":1541710800,\"main\":{\"temp\":279.236,\"temp_min\":279.236,\"temp_max\":279.236,\"pressure\":1032.19,\"sea_level\":1034.81,\"grnd_level\":1032.19,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":80},\"wind\":{\"speed\":2.92,\"deg\":108.003},\"rain\":{\"3h\":0.1625},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-08 21:00:00\"},{\"dt\":1541721600,\"main\":{\"temp\":278.801,\"temp_min\":278.801,\"temp_max\":278.801,\"pressure\":1032.73,\"sea_level\":1035.32,\"grnd_level\":1032.73,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":3.31,\"deg\":103.506},\"rain\":{\"3h\":0.0875},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-09 00:00:00\"},{\"dt\":1541732400,\"main\":{\"temp\":278.444,\"temp_min\":278.444,\"temp_max\":278.444,\"pressure\":1032.82,\"sea_level\":1035.36,\"grnd_level\":1032.82,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":4.26,\"deg\":105.009},\"rain\":{\"3h\":0.0875},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-09 03:00:00\"},{\"dt\":1541743200,\"main\":{\"temp\":278.428,\"temp_min\":278.428,\"temp_max\":278.428,\"pressure\":1033.05,\"sea_level\":1035.59,\"grnd_level\":1033.05,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":4.86,\"deg\":108.502},\"rain\":{\"3h\":0.1375},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-09 06:00:00\"},{\"dt\":1541754000,\"main\":{\"temp\":278.775,\"temp_min\":278.775,\"temp_max\":278.775,\"pressure\":1033.78,\"sea_level\":1036.33,\"grnd_level\":1033.78,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":5.48,\"deg\":114.501},\"rain\":{\"3h\":0.15},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-09 09:00:00\"},{\"dt\":1541764800,\"main\":{\"temp\":278.81,\"temp_min\":278.81,\"temp_max\":278.81,\"pressure\":1033.67,\"sea_level\":1036.23,\"grnd_level\":1033.67,\"humidity\":97,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":5.52,\"deg\":115.001},\"rain\":{\"3h\":0.0625},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-09 12:00:00\"},{\"dt\":1541775600,\"main\":{\"temp\":278.533,\"temp_min\":278.533,\"temp_max\":278.533,\"pressure\":1033.67,\"sea_level\":1036.25,\"grnd_level\":1033.67,\"humidity\":97,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":5.77,\"deg\":115},\"rain\":{\"3h\":0.0875},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-09 15:00:00\"},{\"dt\":1541786400,\"main\":{\"temp\":278.319,\"temp_min\":278.319,\"temp_max\":278.319,\"pressure\":1033.56,\"sea_level\":1036.17,\"grnd_level\":1033.56,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":6.02,\"deg\":118},\"rain\":{\"3h\":0.0625},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-09 18:00:00\"},{\"dt\":1541797200,\"main\":{\"temp\":278.044,\"temp_min\":278.044,\"temp_max\":278.044,\"pressure\":1033.61,\"sea_level\":1036.24,\"grnd_level\":1033.61,\"humidity\":97,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":76},\"wind\":{\"speed\":6.28,\"deg\":125.505},\"rain\":{\"3h\":0.0375},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-09 21:00:00\"},{\"dt\":1541808000,\"main\":{\"temp\":277.486,\"temp_min\":277.486,\"temp_max\":277.486,\"pressure\":1033.61,\"sea_level\":1036.16,\"grnd_level\":1033.61,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":76},\"wind\":{\"speed\":6.45,\"deg\":129.014},\"rain\":{\"3h\":0.025},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-10 00:00:00\"},{\"dt\":1541818800,\"main\":{\"temp\":276.981,\"temp_min\":276.981,\"temp_max\":276.981,\"pressure\":1032.99,\"sea_level\":1035.63,\"grnd_level\":1032.99,\"humidity\":98,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":80},\"wind\":{\"speed\":6.66,\"deg\":132.5},\"rain\":{\"3h\":0.0125},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2018-11-10 03:00:00\"},{\"dt\":1541829600,\"main\":{\"temp\":276.84,\"temp_min\":276.84,\"temp_max\":276.84,\"pressure\":1032.99,\"sea_level\":1035.68,\"grnd_level\":1032.99,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":6.48,\"deg\":138.5},\"rain\":{\"3h\":0.075},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-10 06:00:00\"},{\"dt\":1541840400,\"main\":{\"temp\":276.913,\"temp_min\":276.913,\"temp_max\":276.913,\"pressure\":1033.46,\"sea_level\":1036.1,\"grnd_level\":1033.46,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":6.56,\"deg\":144.501},\"rain\":{\"3h\":0.05},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2018-11-10 09:00:00\"}],\"city\":{\"id\":536203,\"name\":\"Sankt-Peterburg\",\"coord\":{\"lat\":59.9167,\"lon\":30.25},\"country\":\"RU\"}}";


    private StringBuffer sendGet(String url){
        URL obj= null;
        try {
            obj = new URL(url);
            HttpURLConnection connection=(HttpURLConnection)obj.openConnection();
            connection.setRequestMethod("GET");
            BufferedReader in=new BufferedReader(new InputStreamReader(connection.getInputStream()));
            String inputLine;
            StringBuffer response=new StringBuffer();
            while ((inputLine=in.readLine())!=null){
                response.append(inputLine);
            }
            in.close();
            return response;
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }
    private WeatherModel GetJson(StringBuffer jsonBuffer)
    {
        String jsonString=jsonBuffer.toString();
        Gson gson = new Gson();
        WeatherModel o = gson.fromJson(jsonString, WeatherModel.class);
        return o;
    }

    private WeatherForecastModel GetJsonWeatherForecast(StringBuffer jsonBuffer)
    {
        String jsonString=jsonBuffer.toString();
        Gson gson = new Gson();
        WeatherForecastModel o = gson.fromJson(jsonString, WeatherForecastModel.class);
        return o;
    }

    public WeatherModel GetCurrentWeather(HaveCoordinate coordinate){

        return GetJson(sendGet(CreateCall(coordinate,false)));
    }

    public WeatherForecastModel GetForecastWeater(HaveCoordinate coordinate){return GetJsonWeatherForecast(sendGet(CreateCall(coordinate, true)));}

    private String CreateCall(HaveCoordinate coordinate, Boolean forecast){
        coordinate.getCoord();
        StringBuilder sb=new StringBuilder();
        if(forecast){
            sb.append("http://api.openweathermap.org/data/2.5/forecast?lat=")
                    .append(coordinate.getCoord().getLat())
                    .append("&lon=")
                    .append(coordinate.getCoord().getLon())
                    .append("&appid=").append(weatherID);
        }
        else {
            sb.append("http://api.openweathermap.org/data/2.5/weather?lat=")
                    .append(coordinate.getCoord().getLat())
                    .append("&lon=")
                    .append(coordinate.getCoord().getLon())
                    .append("&appid=")
                    .append(weatherID);
        }
        return sb.toString();
    }
}


